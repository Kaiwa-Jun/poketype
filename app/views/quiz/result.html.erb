<%= stylesheet_link_tag 'quiz', media: 'all', 'data-turbolinks-track': 'reload' %>

<div class="container">
  <h2>結果画面</h2>
  <p>正解数: <%= @correct_count %> / <%= @total_questions %></p>
  <ul class="answers">
    <% session[:results].each_with_index do |result, index| %>
      <li class="answer">
        <h3>Question <%= index + 1 %>: 
          <span class="badge <%= "type-#{result['question']}" %>">
            <%= t("types.#{result['question']}") %>
          </span>
        </h3>

        <p><%= result['correct'] ? '正解！' : '不正解' %></p>
        <!--<% result['all_pokemons'].each do |pokemon_id| %>
          <% pokemon = Pokemon.find_by(id: pokemon_id) %>
          <% if pokemon.present? %>
            <%= "Pokemon Name: #{pokemon.name}, Type ID: #{pokemon.type_id}, Secondary Type ID: #{pokemon.secondary_type_id}, Fake Type ID: #{pokemon.fake_type_id}" %><br>
          <% end %>
        <% end %>-->

        <% if result['all_pokemons'].present? %>
          <div class="pokemon-grid">
            <% result['all_pokemons'].each_with_index do |pokemon_id, index| %>
              <% pokemon = Pokemon.find_by(id: pokemon_id) %>
              <% if pokemon.present? && pokemon.image_url.present? %>
                <!-- pokemon-cell クラスを追加 -->
                <div class="pokemon-cell <%= result['correct_pokemons'].include?(pokemon_id) ? 'selected' : '' %>">
                  <%= image_tag pokemon.image_url %>
                  <!--<%= pokemon.name %>-->
                </div>
              <% else %>
                <div class="pokemon-cell">
                  <%= "Pokemon with ID #{pokemon_id} not found or image missing" %>
                </div>
              <% end %>
            <% end %>
          </div>
        <% else %>
          <p>この問題には 'all_pokemons' のデータがありません。</p>
        <% end %>
      </li>
    <% end %>
  </ul>
  <%= link_to 'もう一度', quiz_restart_path, class: 'btn btn-primary' %>
</div>

<style>
  .selected {
    border: 2px solid red;
  }
  /* その他のスタイリング */
</style>
